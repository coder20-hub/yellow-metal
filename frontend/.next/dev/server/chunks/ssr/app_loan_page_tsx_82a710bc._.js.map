{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/koust/Downloads/code/frontend/app/loan/page.tsx"],"sourcesContent":["'use client';\n\nimport Link from 'next/link';\nimport { useEffect, useState, useRef } from 'react';\n\nexport default function LoanPage() {\n  const [loanAppUrl, setLoanAppUrl] = useState<string>('');\n  const [hasError, setHasError] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    // Use the same origin (port 3000) with rewrite path\n    // The rewrite in next.config.mjs will proxy to port 3001\n    if (typeof window !== 'undefined') {\n      // Check if server is reachable first\n      const checkServer = async () => {\n        try {\n          // Try to fetch from the proxy path to see if server is up\n          const response = await fetch('/loan-app/', { \n            method: 'HEAD',\n            cache: 'no-cache'\n          });\n          if (response.ok || response.status === 404) {\n            // Server is responding (404 is ok, means server is up but path might be different)\n            setLoanAppUrl('/loan-app/');\n          } else {\n            // Wait a bit and try again\n            setTimeout(() => setLoanAppUrl('/loan-app/'), 3000);\n          }\n        } catch (error) {\n          // Server not ready yet, wait and try again\n          setTimeout(() => setLoanAppUrl('/loan-app/'), 3000);\n        }\n      };\n      \n      // Initial delay, then check server\n      const timer = setTimeout(() => {\n        checkServer();\n      }, 1000);\n      return () => clearTimeout(timer);\n    }\n  }, []);\n\n  const loadTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const iframeRef = useRef<HTMLIFrameElement | null>(null);\n  const isLoadedRef = useRef(false);\n\n  const handleIframeLoad = () => {\n    isLoadedRef.current = true;\n    if (loadTimeoutRef.current) {\n      clearTimeout(loadTimeoutRef.current);\n      loadTimeoutRef.current = null;\n    }\n    setIsLoading(false);\n    setHasError(false);\n  };\n\n  const handleIframeError = () => {\n    if (loadTimeoutRef.current) {\n      clearTimeout(loadTimeoutRef.current);\n      loadTimeoutRef.current = null;\n    }\n    setIsLoading(false);\n    setHasError(true);\n  };\n\n  // Only set timeout if iframe hasn't loaded yet - increased to 30 seconds\n  useEffect(() => {\n    if (loanAppUrl && isLoading && !hasError && !isLoadedRef.current) {\n      // Give it more time - 30 seconds total\n      loadTimeoutRef.current = setTimeout(() => {\n        // Only show error if still not loaded (check ref, not state to avoid stale closure)\n        if (!isLoadedRef.current) {\n          setIsLoading(false);\n          setHasError(true);\n        }\n      }, 30000); // 30 second timeout\n      return () => {\n        if (loadTimeoutRef.current) {\n          clearTimeout(loadTimeoutRef.current);\n          loadTimeoutRef.current = null;\n        }\n      };\n    }\n  }, [loanAppUrl, isLoading, hasError]);\n\n  return (\n    <div className=\"w-full h-screen relative bg-white\">\n      {/* Back Button */}\n      <Link\n        href=\"/\"\n        className=\"absolute top-4 left-4 z-50 flex items-center gap-2 px-4 py-2 bg-white rounded-lg shadow-md hover:shadow-lg transition-all duration-200 text-gray-900 hover:text-gray-700 border border-gray-200\"\n      >\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          className=\"h-5 w-5\"\n          viewBox=\"0 0 20 20\"\n          fill=\"currentColor\"\n        >\n          <path\n            fillRule=\"evenodd\"\n            d=\"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z\"\n            clipRule=\"evenodd\"\n          />\n        </svg>\n        <span className=\"text-sm font-medium\">Back to Home</span>\n      </Link>\n\n      {/* Loading State */}\n      {isLoading && !hasError && (\n        <div className=\"absolute inset-0 flex items-center justify-center bg-white z-40\">\n          <div className=\"text-center\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4\"></div>\n            <p className=\"text-gray-600\">Loading Gold Loan Application...</p>\n            <p className=\"text-gray-500 text-sm mt-2\">Please wait while the server starts...</p>\n          </div>\n        </div>\n      )}\n\n      {/* Error State */}\n      {hasError && (\n        <div className=\"absolute inset-0 flex items-center justify-center bg-white z-40\">\n          <div className=\"text-center px-4 max-w-md\">\n            <div className=\"text-red-600 mb-4\">\n              <svg className=\"w-16 h-16 mx-auto\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n              </svg>\n            </div>\n            <h2 className=\"text-xl font-bold text-gray-900 mb-2\">Unable to Load Loan Application</h2>\n            <p className=\"text-gray-600 mb-4\">The loan app server on port 3001 is not running.</p>\n            <div className=\"bg-gray-50 p-4 rounded-lg mb-4 text-left\">\n              <p className=\"text-sm font-semibold text-gray-900 mb-2\">To fix this:</p>\n              <ol className=\"text-sm text-gray-700 space-y-1 list-decimal list-inside\">\n                <li>Stop the current server (Ctrl+C)</li>\n                <li>Run: <code className=\"bg-gray-200 px-1 rounded\">npm run dev</code></li>\n                <li>Wait for both servers to start</li>\n                <li>Refresh this page</li>\n              </ol>\n            </div>\n            <button\n              onClick={() => {\n                isLoadedRef.current = false;\n                setHasError(false);\n                setIsLoading(true);\n                setLoanAppUrl('');\n                if (loadTimeoutRef.current) {\n                  clearTimeout(loadTimeoutRef.current);\n                  loadTimeoutRef.current = null;\n                }\n                setTimeout(() => {\n                  setLoanAppUrl('/loan-app/');\n                }, 1000);\n              }}\n              className=\"px-6 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition\"\n            >\n              Retry\n            </button>\n          </div>\n        </div>\n      )}\n\n      {loanAppUrl && !hasError && (\n        <iframe\n          ref={iframeRef}\n          src={loanAppUrl}\n          className=\"w-full h-full border-0\"\n          title=\"Gold Loan Application\"\n          allow=\"fullscreen\"\n          onLoad={handleIframeLoad}\n          onError={handleIframeError}\n        />\n      )}\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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"}}]
}